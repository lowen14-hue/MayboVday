<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Valentine Quest Map ğŸ’–</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  font-family: 'Segoe UI', sans-serif;
  background: #ffc0cb;
  overflow: hidden;
}

/* Game container */
.game {
  width: 100vw;
  height: 100vh;
  position: relative;
}

/* Player avatar */
#player {
  position: absolute;
  font-size: 3rem;
  z-index: 10;
}

/* Landmarks / islands */
.landmark {
  position: absolute;
  font-size: 3rem;
  cursor: pointer;
  transition: transform 0.3s;
  z-index: 11;
}
.landmark.locked { opacity: 0.5; pointer-events: none; }
.landmark:hover:not(.locked) { transform: scale(1.5); }

/* Paths */
.path-line {
  position: absolute;
  height: 6px;
  background: linear-gradient(90deg,#ff6f91,#ffd1dc);
  border-radius: 10px;
  box-shadow: 0 0 10px #ff6f91,0 0 20px #ffd1dc;
  z-index: 1;
}

/* Modal */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 30;
}
.modal-content {
  background: white;
  padding: 30px;
  border-radius: 15px;
  text-align: center;
  width: 90%;
  max-width: 400px;
}
.modal-content input, .modal-content button {
  width: 90%;
  padding: 10px;
  margin-top: 10px;
  font-size: 1rem;
}

/* Progress bar */
#progressBar {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 25px;
  background: #ffe6f0;
  z-index: 20;
}
#progressFill {
  height: 100%;
  width: 0%;
  background: #ff6f91;
  transition: width 0.5s ease;
}

/* Flashing red for No screen */
.flashRed { animation: flashRedAnim 0.15s infinite alternate; z-index:50; }
@keyframes flashRedAnim { from { background: white; } to { background: red; } }

/* Confetti / hearts */
.confetti, .heart {
  position: fixed;
  font-size: 2rem;
  animation: fall 2s linear forwards;
  pointer-events: none;
  z-index: 20;
}
@keyframes fall { from { transform: translateY(-20px); opacity: 1; } to { transform: translateY(100vh); opacity: 0; } }

</style>
</head>
<body>

<div class="game" id="game">
  <div id="progressBar"><div id="progressFill"></div></div>

  <!-- Player avatar -->
  <div id="player">ğŸ‘§ğŸ½</div>

  <!-- Emoji islands / levels -->
  <div class="landmark" data-level="0" style="top:80px; left:100px;">ğŸŒ²</div>
  <div class="landmark locked" data-level="1" style="top:200px; left:400px;">ğŸ“¸</div>
  <div class="landmark locked" data-level="2" style="top:350px; left:700px;">ğŸï¸</div>
  <div class="landmark locked" data-level="3" style="top:500px; left:950px;">ğŸ</div>
  <div class="landmark locked" data-level="4" style="top:600px; left:750px;">ğŸ¶</div>
  <div class="landmark locked" data-level="5" style="top:450px; left:1100px;">ğŸ¦–</div>
  <div class="landmark locked" data-level="6" style="top:300px; left:1250px;">âš“</div>
  <div class="landmark locked" data-level="7" style="top:150px; left:1400px;">ğŸ°</div>

  <!-- Path container -->
  <div id="pathContainer"></div>
</div>

<div class="modal" id="modal">
  <div class="modal-content" id="modalContent"></div>
</div>

<script>
const levels = document.querySelectorAll('.landmark');
const player = document.getElementById('player');
const progressFill = document.getElementById('progressFill');
const modal = document.getElementById('modal');
const modalContent = document.getElementById('modalContent');
const pathContainer = document.getElementById('pathContainer');
let progress = 0;

const challenges = [
  { text: "Where did we go the first time I knew I loved you?", answer: "sargent peps" },
  { text: "Where was our first photo taken?", answer: "towers girls bathroom" },
  { text: "Where were we when I surprised you in Florida?", answer: "st armands circle" },
  { text: "ğŸ What is our favorite meal that I make soooo good?", answer: "shrimp scampi" },
  { text: "ğŸ¶ What was the name of our AI dog?", answer: "chase" },
  { text: "ğŸ¦– RAWR! Danny the dinosaur is jamming â€” what is his favorite song?", answer: "dancing in the moonlight" },
  { text: "âš“ğŸŒŠ Ahoy! Best place Iâ€™ve ever taken you to eat?", answer: "cliff house" }
];

// Draw glowing paths (straight lines for now)
for(let i=0;i<levels.length-1;i++){
  const start=levels[i].getBoundingClientRect();
  const end=levels[i+1].getBoundingClientRect();
  const line=document.createElement('div');
  line.className='path-line';
  const dx=end.left-start.left;
  const dy=end.top-start.top;
  const length=Math.sqrt(dx*dx+dy*dy);
  const angle=Math.atan2(dy,dx)*180/Math.PI;
  line.style.width=length+'px';
  line.style.top=(start.top+start.height/2)+'px';
  line.style.left=(start.left+start.width/2)+'px';
  line.style.transform=`rotate(${angle}deg)`;
  pathContainer.appendChild(line);
}

// Move avatar smoothly along path
function movePlayerToLevel(i){
  const rect=levels[i].getBoundingClientRect();
  player.style.top=(rect.top + window.scrollY - 25)+'px';
  player.style.left=(rect.left + window.scrollX)+'px';
  progressFill.style.width=((i/(levels.length-1))*100)+'%';
}
movePlayerToLevel(0);

// Level clicks
levels.forEach(level=>{
  level.addEventListener('click',()=>{
    const i=Number(level.dataset.level);
    if(i!==progress || level.classList.contains('locked')) return;
    if(i<challenges.length) openChallenge(i);
    else showFinal();
  });
});

function normalize(str){ return str.toLowerCase().replace(/[^a-z0-9\s]/g,''); }

function openChallenge(i){
  modal.style.display='flex';
  modalContent.innerHTML=`<h2>${challenges[i].text}</h2>
    <input id="answer" placeholder="Your answer..." />
    <br><br>
    <button onclick="checkAnswer(${i})">Submit</button>`;
}

function checkAnswer(i){
  const user=normalize(document.getElementById('answer').value);
  const target=normalize(challenges[i].answer).split(' ');
  const correct=target.every(word=>user.includes(word));
  if(!correct){ alert("Not quite ğŸ˜ try again"); return; }
  modal.style.display='none';
  levels[i].classList.add('completed');
  progress++;
  levels[progress]?.classList.remove('locked');
  movePlayerToLevel(i);
}

function showFinal(){
  modal.style.display='flex';
  modalContent.innerHTML=`<h2>ğŸ’– You made it ğŸ’–</h2>
    <p>Will you be my Valentine?</p>
    <button onclick="yes()">Yes ğŸ’•</button>
    <button onclick="nope()" style="margin-left:10px;background:#555;color:white;">No</button>`;
}

function nope(){
  modalContent.innerHTML=`<div class="flashRed" style="height:200px;">
    <div style="font-size:5rem">ğŸƒ</div><h2>Get Fucked</h2></div>`;
  setTimeout(showFinal,10000);
}

function yes(){
  modalContent.innerHTML=`<h2>ğŸ¥° YAY ğŸ¥°</h2><p>I was hoping you'd say yes.</p>`;
  for(let i=0;i<50;i++){ spawn('ğŸ‰'); spawn('ğŸ’–'); }
}

function spawn(symbol){
  const el=document.createElement('div');
  el.className=symbol==='ğŸ‰'?'confetti':'heart';
  el.textContent=symbol;
  el.style.left=Math.random()*100+'vw';
  el.style.animationDuration=(1+Math.random()*2)+'s';
  document.body.appendChild(el);
  setTimeout(()=>el.remove(),3000);
}
</script>
</body>
</html>
