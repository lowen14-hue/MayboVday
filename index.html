<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Valentine Quest ğŸ’–</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg, #ff9a9e, #fad0c4);
  overflow: hidden;
}

/* Game Container */
.game {
  position: relative;
  width: 90%;
  max-width: 900px;
  height: 90vh;
  margin: auto;
  background: url('https://i.imgur.com/t0yS2fE.png') no-repeat center/cover; /* Optional map background */
  border-radius: 20px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.2);
  overflow: hidden;
}

/* Level nodes */
.level {
  position: absolute;
  width: 100px;
  height: 100px;
  border-radius: 50%;
  background: #f1f1f1;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
  border: 3px solid #fff;
  box-shadow: 0 0 5px rgba(0,0,0,0.3);
}
.level:hover {
  transform: scale(1.2);
  box-shadow: 0 0 15px rgba(255,255,255,0.8);
}
.locked {
  background: #ddd;
  cursor: not-allowed;
}
.completed {
  background: #caffbf;
  animation: pulse 1s infinite alternate;
}

/* Level glow pulse */
@keyframes pulse {
  from { transform: scale(1); box-shadow: 0 0 10px #caffbf; }
  to { transform: scale(1.1); box-shadow: 0 0 25px #90ee90; }
}

/* Modal */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 10;
}
.modal-content {
  background: white;
  padding: 30px;
  border-radius: 15px;
  max-width: 400px;
  width: 90%;
  text-align: center;
}
.modal-content input, .modal-content button {
  width: 90%;
  padding: 10px;
  font-size: 1rem;
  margin-top: 10px;
}
.flash {
  animation: flashRed 0.15s infinite alternate;
}
@keyframes flashRed {
  from { background: white; }
  to { background: red; }
}

/* Special Animations */
@keyframes roar {
  from { transform: scale(1) rotate(-5deg); }
  to { transform: scale(1.3) rotate(5deg); }
}
.wave {
  animation: wave 0.8s ease-in-out 4;
}
@keyframes wave {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(2deg); }
  50% { transform: rotate(0deg); }
  75% { transform: rotate(-2deg); }
  100% { transform: rotate(0deg); }
}

/* Floating effects */
.effect {
  position: fixed;
  font-size: 2rem;
  animation: float 3s linear forwards;
  pointer-events: none;
  z-index: 20;
}
@keyframes float {
  from { transform: translateY(0) rotate(0deg); opacity: 1; }
  to { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
}

/* Paths between levels */
.path {
  position: absolute;
  width: 4px;
  background: #fff8;
  transform-origin: top left;
  z-index: 5;
}
</style>
</head>
<body>

<div class="game" id="game">
  <!-- Level nodes -->
  <div class="level" data-level="0" style="top:10%; left:10%;">ğŸŒ²</div>
  <div class="level locked" data-level="1" style="top:15%; left:70%;">ğŸ“¸</div>
  <div class="level locked" data-level="2" style="top:40%; left:20%;">ğŸï¸</div>
  <div class="level locked" data-level="3" style="top:50%; left:65%;">ğŸ</div>
  <div class="level locked" data-level="4" style="top:70%; left:15%;">ğŸ¶</div>
  <div class="level locked" data-level="5" style="top:75%; left:50%;">ğŸ¦–</div>
  <div class="level locked" data-level="6" style="top:60%; left:80%;">âš“</div>
  <div class="level locked" data-level="7" style="top:5%; left:50%;">ğŸ°</div>
</div>

<div class="modal" id="modal">
  <div class="modal-content" id="modalContent"></div>
</div>

<script>
const levels = document.querySelectorAll('.level');
const modal = document.getElementById('modal');
const modalContent = document.getElementById('modalContent');
const game = document.getElementById('game');
let progress = 0;

const challenges = [
  { text: "Where did we go the first time I knew I loved you?", answer: "sargent peps" },
  { text: "Where was our first photo taken?", answer: "towers girls bathroom" },
  { text: "Where were we when I surprised you in Florida?", answer: "st armand's circle" },
  { text: "ğŸ What is our favorite meal that I make soooo good?", answer: "shrimp scampi" },
  { text: "ğŸ¶ What was the name of our AI dog?", answer: "chase" },
  { text: "ğŸ¦– RAWR! Danny the dinosaur is jamming â€” what is his favorite song?", answer: "dancing in the moonlight" },
  { text: "âš“ğŸŒŠ Ahoy! Best place Iâ€™ve ever taken you to eat?", answer: "cliff house" }
];

levels.forEach(level => {
  level.addEventListener('click', () => {
    const i = Number(level.dataset.level);
    if (i !== progress) return;
    if (i < challenges.length) openChallenge(i);
    else showFinal();
  });
});

function normalize(str) {
  return str.toLowerCase().replace(/[^a-z0-9\s]/g, '');
}

function openChallenge(i) {
  modal.style.display = 'flex';
  modalContent.innerHTML = `
    <h2>${challenges[i].text}</h2>
    <input id="answer" placeholder="Your answer..." />
    <br><br>
    <button onclick="checkAnswer(${i})">Submit</button>
  `;
}

function checkAnswer(i) {
  const user = normalize(document.getElementById('answer').value);
  const target = normalize(challenges[i].answer).split(' ');
  const correct = target.every(word => user.includes(word));

  if (!correct) {
    alert("Not quite ğŸ˜ try again");
    return;
  }

  modal.style.display = 'none';
  levels[i].classList.add('completed');
  progress++;
  levels[progress]?.classList.remove('locked');

  // Level-specific effects
  switch(i) {
    case 0: spawnEffects(['ğŸŒ¿','ğŸƒ']); break;
    case 1: spawnEffects(['ğŸ“¸','âœ¨']); break;
    case 2: spawnEffects(['ğŸŒ','ğŸŒŠ']); break;
    case 3: spawnEffects(['ğŸ','ğŸ’–']); break;
    case 4: spawnEffects(['ğŸ¶','ğŸ¥']); break;
    case 5: dinoCelebrate(); break;
    case 6: waveCelebrate(); spawnEffects(['âš“','ğŸŒŠ']); break;
  }
}

function spawnEffects(symbols, count=15) {
  for (let i = 0; i < count; i++) {
    const el = document.createElement('div');
    el.className = 'effect';
    el.textContent = symbols[Math.floor(Math.random() * symbols.length)];
    el.style.left = Math.random() * 100 + 'vw';
    el.style.fontSize = 1.5 + Math.random() * 2 + 'rem';
    el.style.animationDuration = 2 + Math.random() * 2 + 's';
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 3000);
  }
}

function dinoCelebrate() {
  const dino = document.createElement('div');
  dino.textContent = 'ğŸ¦– RAWR!';
  dino.style.position = 'fixed';
  dino.style.inset = '0';
  dino.style.display = 'flex';
  dino.style.alignItems = 'center';
  dino.style.justifyContent = 'center';
  dino.style.fontSize = '4rem';
  dino.style.animation = 'roar 0.4s infinite alternate';
  dino.style.zIndex = '25';
  document.body.appendChild(dino);
  setTimeout(() => dino.remove(), 1500);
}

function waveCelebrate() {
  game.classList.add('wave');
  setTimeout(() => game.classList.remove('wave'), 1200);
}

function showFinal() {
  modal.style.display = 'flex';
  modalContent.innerHTML = `
    <h2>ğŸ’– You made it ğŸ’–</h2>
    <p>Will you be my Valentine?</p>
    <button onclick="yes()">Yes ğŸ’•</button>
    <button onclick="nope()" style="margin-left:10px;background:#555;color:white;">No</button>
  `;
}

function nope() {
  modal.classList.remove('flash');
  void modal.offsetWidth;
  modal.classList.add('flash');

  modalContent.innerHTML = `
    <div style="font-size:5rem">ğŸƒ</div>
    <h2>Get rejected ğŸ˜…</h2>
  `;

  setTimeout(() => {
    modal.classList.remove('flash');
    showFinal();
  }, 15000);
}

function yes() {
  modalContent.innerHTML = `
    <h2>ğŸ¥° YAY ğŸ¥°</h2>
    <p>I was hoping you'd say yes.</p>
  `;
  spawnEffects(['ğŸ‰','ğŸ’–'], 50);
}
</script>
</body>
</html>
